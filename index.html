<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Par for the Course - Classic</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #fff;
            text-align: center;
        }

        #splash-screen, #player-setup, #game-area {
            max-width: 400px;
            margin: 20px auto;
            display: none;
        }

        #splash-screen img {
            width: 100%;
            max-width: 300px;
        }

        input[type="text"] {
            width: 80%;
            padding: 8px;
            margin-bottom: 10px;
        }

        .btn {
            padding: 10px 20px;
            background-color: #d11111;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn:hover {
            background-color: #a50e0e;
        }

        .player-score {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 5px 0;
        }

        .increment-btns {
            display: flex;
            justify-content: center;
            background-color: #d11111;
            color: white;
            gap: 5px;
            margin: 10px 0;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
            background-color: #d11111;
            color: white;
            border: none;
            border-radius: 5px;
        }

        .btn-small:hover {
            background-color: #a50e0e;
        }

        .card-image {
            width: 100%;
            max-width: 400px;
            margin: 20px 0;
        }

        #box-score {
            margin: 20px auto;
            width: 100%;
            max-width: 400px;
            border-collapse: collapse;
        }

        #box-score td, #box-score th {
            border: 1px solid #fff;
            padding: 8px;
            text-align: center;
        }

        #box-score th {
            background-color: #d11111;
        }

        footer {
            margin: 20px auto;
            color: #fff;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div id="splash-screen">
        <img src="images/Splash-Screen.png" alt="Splash Screen">
        <button id="setup-game" class="btn">Next</button>
    </div>

    <div id="player-setup" style="display: none;">
        <h2>Enter Player Names</h2>
        <div id="player-inputs">
            <div>
                <input type="text" class="player-name-input" placeholder="Player Name">
            </div>
        </div>
        <button id="add-player" class="btn">Add Player</button>
        <button id="start-game" class="btn">Start Game</button>
    </div>

    <div id="game-area" style="display: none;">
        <h2>Current Card</h2>
        <img id="current-card" class="card-image" src="images/card1.png" alt="Card Image">
        <div id="player-scores"></div>
        <div id="increment-buttons"></div>
        <button id="next-hole" class="btn">Next Card</button>
        <button id="restart-game" class="btn">Restart</button>
        <button id="reset-scores" class="btn">Reset Scores</button>
        <button id="toggle-box-score" class="btn">Show Box Score</button>
        <table id="box-score" style="display: none;"></table>
    </div>

    <footer>
        <h6>v 0.7.7.2</h6>
    </footer>

    <script>
        // Global Variables
        let playerScores = [];
        let currentCardIndex = 0;
        let isBoxScoreVisible = false;

        // Array of Card Images (Preloading)
        const cardImages = Array.from({ length: 18 }, (_, i) => {
            const img = new Image();
            img.src = `images/card${i + 1}.png`;
            return img;
        });

        // Shuffle Cards
        const shuffleCards = () => {
            for (let i = cardImages.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cardImages[i], cardImages[j]] = [cardImages[j], cardImages[i]];
            }
        };

        // Update Game Display
        const updateGameDisplay = () => {
            const currentCard = cardImages[currentCardIndex];
            document.getElementById("current-card").src = currentCard.src;

            const playerScoresDiv = document.getElementById("player-scores");
            playerScoresDiv.innerHTML = playerScores.map(player => `
                <div class="player-score">
                    <span>${player.name}: ${player.totalScore}</span>
                </div>
            `).join("");

            const incrementButtonsDiv = document.getElementById("increment-buttons");
            incrementButtonsDiv.innerHTML = playerScores.map((player, idx) => `
                <div class="increment-btns">
                    <button class="btn-small" onclick="adjustScore(${idx}, 1)">+1</button>
                    <button class="btn-small" onclick="adjustScore(${idx}, -1)">-1</button>
                </div>
            `).join("");

            updateBoxScore();
        };

        // Adjust Player Scores
        const adjustScore = (playerIndex, adjustment) => {
            const player = playerScores[playerIndex];
            player.scores[currentCardIndex] += adjustment;
            player.totalScore = player.scores.reduce((a, b) => a + b, 0);
            updateGameDisplay();
        };

        // Update Box Score Table
        const updateBoxScore = () => {
            const boxScore = document.getElementById("box-score");
            boxScore.innerHTML = `
                <tr>
                    <th>Player</th>
                    ${Array.from({ length: 18 }, (_, i) => `<th>${i + 1}</th>`).join("")}
                    <th>Total</th>
                </tr>
                ${playerScores.map(player => `
                    <tr>
                        <td>${player.name}</td>
                        ${player.scores.map(score => `<td>${score}</td>`).join("")}
                        <td>${player.totalScore}</td>
                    </tr>
                `).join("")}
            `;
        };

        // Toggle Box Score Visibility
        const toggleBoxScore = () => {
            const boxScoreTable = document.getElementById("box-score");
            const toggleButton = document.getElementById("toggle-box-score");

            isBoxScoreVisible = !isBoxScoreVisible;

            if (isBoxScoreVisible) {
                boxScoreTable.style.display = "table";
                toggleButton.textContent = "Hide Box Score";
            } else {
                boxScoreTable.style.display = "none";
                toggleButton.textContent = "Show Box Score";
            }
        };

        // Restart Game
        const restartGame = () => {
            if (confirm("This will CLEAR ALL player names and scores. Are you sure you want to restart the game?")) {
                playerScores = [];
                currentCardIndex = 0;
                shuffleCards();
                document.getElementById("splash-screen").style.display = "block";
                document.getElementById("player-setup").style.display = "none";
                document.getElementById("game-area").style.display = "none";
            }
        };

        // Reset Scores
        const resetScores = () => {
            if (confirm("Are you sure you want to reset all scores?")) {
                playerScores.forEach(player => {
                    player.scores.fill(0);
                    player.totalScore = 0;
                });
                updateGameDisplay();
            }
        };

        // Event Listeners
        document.getElementById("setup-game").addEventListener("click", () => {
            document.getElementById("splash-screen").style.display = "none";
            document.getElementById("player-setup").style.display = "block";
        });

        document.getElementById("add-player").addEventListener("click", () => {
            const playerInputs = document.getElementById("player-inputs");
            const playerInputField = document.createElement("div");
            playerInputField.innerHTML = `
                <input type="text" class="player-name-input" placeholder="Player Name">
            `;
            playerInputs.appendChild(playerInputField);
        });

        document.getElementById("start-game").addEventListener("click", () => {
            const playerNames = Array.from(document.querySelectorAll(".player-name-input"))
                .map(input => input.value.trim());

            const uniqueNames = new Set(playerNames.filter(name => name.length > 0));

            if (uniqueNames.size !== playerNames.length) {
                alert("Player names cannot be empty and must be unique (no duplicates).");
                return;
            }

            playerScores = Array.from(uniqueNames).map(name => ({
                name,
                scores: Array(18).fill(0),
                totalScore: 0,
            }));

            document.getElementById("player-setup").style.display = "none";
            document.getElementById("game-area").style.display = "block";

            shuffleCards();
            updateGameDisplay();
        });

        document.getElementById("next-hole").addEventListener("click", () => {
            currentCardIndex++;
            if (currentCardIndex >= cardImages.length) {
                currentCardIndex = 0;
            }
            updateGameDisplay();
        });

        document.getElementById("restart-game").addEventListener("click", restartGame);
        document.getElementById("reset-scores").addEventListener("click", resetScores);
        document.getElementById("toggle-box-score").addEventListener("click", toggleBoxScore);

        // Initialize
        shuffleCards();
        document.getElementById("splash-screen").style.display = "block";
    </script>
</body>
    <footer>v 0.7.8.3</footer>
</html>
